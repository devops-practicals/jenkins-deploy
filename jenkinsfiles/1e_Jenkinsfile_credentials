/*
Jenkins Pipeline Example: Using AWS Credentials for CLI Operations

This pipeline demonstrates:
- How to securely inject AWS credentials (Access Key ID and Secret Access Key) into a Jenkins Pipeline stage.
- How to use those credentials with the AWS CLI tool in a shell command.

Instructions to add credentials in Jenkins:
1. Go to Jenkins Home page > Credentials > System > Add Credentials.
2. Select Scope as Global.
3. For AWS credentials, add each as a secret text:
    - For Access Key ID:
        * Type: Secret text
        * ID: 'jenkins-aws-secret-key-id'
        * Secret: Enter your IAM User Access Key ID.
    - For Secret Access Key:
        * Type: Secret text
        * ID: 'jenkins-aws-secret-access-key'
        * Secret: Enter your IAM User Secret Access Key.

Usage Notes:
- Never echo secrets in your pipeline output.
- The AWS CLI will automatically detect these environment variables, allowing you to run AWS commands securely.

Security Best Practice:
Never print secrets (like AWS keys) in logs. This example shows proper credential usage with Jenkins.
*/

pipeline {
    // Use any available Jenkins agent to run this pipeline.
    agent any

    stages {
        // Stage for performing AWS operations.
        stage('AWS Stage') {
            // Inject AWS credentials as environment variables for this stage.
            environment {
                // These environment variables are automatically used by AWS CLI.
                AWS_ACCESS_KEY_ID = credentials('jenkins-aws-secret-key-id')
                AWS_SECRET_ACCESS_KEY = credentials('jenkins-aws-secret-access-key')
            }
            steps {
                // Example AWS CLI command: List EC2 instances in the us-east-1 region.
                // The injected credentials will be used for authentication.
                sh 'aws ec2 describe-instances --region us-east-1'
            }
        }
    }
}