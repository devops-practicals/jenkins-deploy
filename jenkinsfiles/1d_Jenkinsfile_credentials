/*
Jenkins Pipeline Example: Using Credentials and Environment Variables

Instructions:
1. To add credentials in Jenkins:
   - Navigate to Jenkins Home page > Credentials > System > Add Credentials
   - Select Scope as Global

2. Types of credentials you can add:
   - Secret text: a token such as an API token (e.g., a GitHub personal access token)
   - Username and password: usually stored as username:password

3. To access credentials in your pipeline:
   - Use the `credentials('ID')` helper to bind the credential value to an environment variable.
   - You can also use the `withCredentials()` step for fine-grained control.

This sample pipeline demonstrates:
- How to configure a Jenkins pipeline to access stored credentials and environment variables.
- How to echo the values to the shell (for demonstration only; do NOT echo secrets in real pipelines!).

*/

pipeline {
    // Specifies the agent where the pipeline will run ('any' means use any available agent).
    agent any

    // Define global environment variables for this pipeline.
    environment {
        // Binds the value of the Jenkins credential with ID 'TEST' to the variable 'secret'.
        // The credential ID 'TEST' must exist in Jenkins credentials.
        secret = credentials('TEST')
        // Sets a static environment variable called TEST_ENV.
        TEST_ENV = 'dev'
    }

    stages {
        // Pipeline consists of one example stage.
        stage('Example stage 1') {
            steps {
                // Prints the value of the 'secret' credential to the shell.
                // WARNING: Never print real secrets in production pipelines!
                sh 'echo $secret'

                // Prints the value of the TEST_ENV variable.
                sh 'echo $TEST_ENV'
            }
        }
    }
}